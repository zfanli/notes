# 1.Official Documentation - Introducing Swift 5

é˜…è¯»å®˜æ–¹å¯¹äº Swift 5 çš„ä»‹ç»ï¼Œäº†è§£å®ƒçš„ç‰¹æ€§å’Œä¼˜åŠ¿ã€‚å¤šæ•°éƒ½æ˜¯æ‘˜æŠ„åŸæ–‡æˆ–è€…ç¿»è¯‘ã€‚

https://developer.apple.com/swift/

## æ‰‰é¡µ Swift 5

ä¸€é—¨åŠŸèƒ½å¼ºå¤§çš„è¯­è¨€ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºå­¦ä¹ ã€‚

Swift æ˜¯ä¸€é—¨åŠŸèƒ½å¼ºå¤§ï¼ˆpowerfulï¼‰ä¸”ç›´è§‚ï¼ˆintuitiveï¼‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œç”¨äº macOSã€iOSã€watchOSã€tvOS ç”šè‡³æ˜¯å…¶ä»–å¹³å°ã€‚ç”¨ Swift ç¼–ç¨‹æ˜¯äº¤äº’å¼ä¸”æœ‰è¶£çš„ï¼Œå®ƒçš„è¯­æ³•ç®€æ´å¹¶ä¸”è¡¨è¾¾åŠ›å¼ºï¼Œå®ƒè¿˜åŒ…å«äº†ä¼—å¤šå¼€å‘è€…å–œçˆ±çš„ç‰¹æ€§ã€‚Swift ä»£ç ä»è®¾è®¡ä¸Šè€ƒè™‘å®‰å…¨æ€§ï¼Œä½¿ç”¨å®ƒåˆ¶ä½œçš„è½¯ä»¶è¿è¡Œèµ·æ¥ä¾æ—§å¿«å¦‚é—ªç”µã€‚

> Rï¼šæ‰‰é¡µçš„ç‰›å¹å¾—ä¸é”™ã€‚

## Swift 5 ç®€ä»‹

Swift 5 ä½¿ä½ å‘å¸ƒè‡ªå·±çš„ App å˜å¾—å¼‚å¸¸ç®€å•ã€‚å› ä¸º Swift 5 çš„è¿è¡Œç¯å¢ƒå¦‚ä»Šå·²ç»å†…ç½®äº macOSã€iOSã€watchOSã€tvOS çš„ç³»ç»Ÿä¸­ï¼Œä½ çš„ App åœ¨è¿™äº›å¹³å°çš„æœ€æ–°ç³»ç»Ÿä¸Šä¸å†éœ€è¦ç»‘å®šå®ƒçš„è¿è¡Œç¯å¢ƒåŒ…äº†ã€‚ä» Apple Store ä¸­ä¸‹è½½ Swift çš„ App å°†ä¼šæ¯”ä»¥å¾€ä½“ç§¯æ›´å°ã€ä¸‹è½½é€Ÿåº¦æ›´å¿«ã€‚

ä¸‹é¢æ˜¯å®ƒçš„é™„åŠ ç‰¹æ€§ã€‚

- å­—ç¬¦ä¸²ä½¿ç”¨ UTF-8 ç¼–ç 
- Debug å’Œ release builds ä¸‹é»˜è®¤å¼ºåˆ¶å¯¹å†…å­˜ç‹¬å è®¿é—®
- SIMD Vector and Result types in Standard Library
- Dictionary å’Œ Set çš„æ€§èƒ½æ”¹å–„
- æ”¯æŒåŠ¨æ€å¯è°ƒç”¨ç±»å‹ï¼ˆdynamically callable typesï¼‰ä»¥æ”¹å–„ä¸åŠ¨æ€è¯­è¨€ï¼ˆPythonã€JavaScriptã€Ruby ç­‰ï¼‰çš„äº¤äº’æ€§

> Rï¼šä¸æ˜è§‰å‰ã€‚

## ç°ä»£åŒ–

Swift æ˜¯ç»“åˆå‡ åå¹´æ„å»º Apple å¹³å°çš„ç»éªŒï¼Œå¯¹ç¼–ç¨‹è¯­è¨€ç ”ç©¶çš„æœ€æ–°æˆæœã€‚ä»¥æ¸…æ™°çš„è¯­æ³•è¡¨è¾¾å‘½åå‚æ•°ï¼ˆNamed parametersï¼‰ï¼Œå¯ä»¥ä½¿ Swift çš„ API æ›´åŠ å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ã€‚ä½ ç”šè‡³ä¸éœ€è¦è¾“å…¥åˆ†å·ã€‚ç±»å‹æ¨æµ‹è®©ä»£ç æ›´åŠ æ¸…æ™°ã€æ›´ä¸æ˜“å‡ºé”™ï¼Œè€Œ modules çš„å­˜åœ¨æ‘†è„±äº† headers å¹¶ä¸”æä¾›å‘½åç©ºé—´ã€‚å­—ç¬¦ä¸² Unicode-correctï¼ŒåŸºäº UTF-8 ç¼–ç å¹¶å¯¹å„ç§ä½¿ç”¨åœºæ™¯è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ä»¥æ›´å¥½çš„æ”¯æŒå›½é™…åŒ–è¯­è¨€å’Œ emojiã€‚è‡ªåŠ¨å†…å­˜ç®¡ç†åŸºäºä¸¥æ ¼ç¡®å®šæ€§çš„å˜é‡å¼•ç”¨è®¡ç®—ï¼Œä¿æŒæœ€ä½å†…å­˜ä½¿ç”¨ç‡çš„åŒæ—¶ï¼Œæ²¡æœ‰åƒåœ¾å›æ”¶çš„å¼€é”€ã€‚

ä¸‹é¢çš„ä¾‹å­å±•ç¤ºç°ä»£åŒ–ç›´è§‚çš„è¯­æ³•å£°æ˜ä¸€ä¸ªç±»å‹ã€‚ä¸ºå®ä¾‹å±æ€§æ·»åŠ é»˜è®¤å€¼ï¼Œå¹¶ä¸”è‡ªå®šä¹‰åˆå§‹åŒ–å™¨ã€‚

```swift
struct Player {
    var name: String
    var highScore: Int = 0
    var history: [Int] = []

    init(_ name: String) {
        self.name = name
    }
}

var player = Player("Tomas")
```

ä½¿ç”¨ `extension` å¯¹ç°æœ‰çš„ç±»å‹è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼æ¨¡ç‰ˆå‡å°‘é‡å¤ä»£ç ã€‚

```swift
extension Player {
    mutating func updateScore(_ newScore: Int) {
        history.append(newScore)
        if highScore < newScore {
            print("\(newScore)! A new high score for \(name)! ğŸ‰")
            highScore = newScore
        }
    }
}

player.updateScore(50)
// Prints "50! A new high score for Tomas! ğŸ‰"
// player.highScore == 50
```

åˆ©ç”¨åŠŸèƒ½å¼ºå¤§çš„è¯­è¨€ç‰¹æ€§å¿«é€Ÿæ‰©å±•ä½ çš„è‡ªå®šä¹‰ç±»å‹ï¼Œæ¯”å¦‚è‡ªåŠ¨ç¼–ç Â·è§£ç  JSON æ ¼å¼æ•°æ®ã€‚

```swift
extension Player: Codable, Equatable {}

import Foundation
let encoder = JSONEncoder()
try encoder.encode(player)

print(player)
// Prints "Tomas, games played: 1, high score: 50â€
```

ä½¿ç”¨æœ€æ–°ç®€åŒ–çš„é—­åŒ…å‡½æ•°æ‰§è¡ŒåŠŸèƒ½å¼ºå¤§çš„è‡ªå®šä¹‰å˜æ¢ã€‚

```swift
let players = getPlayers()

// Sort players, with best high scores first
let ranked = players.sorted(by: { player1, player2 in
    player1.highScore > player2.highScore
})

// Create an array with only the playersâ€™ names
let rankedNames = ranked.map { $0.name }
// ["Erin", "Rosana", "Tomas"]
```

è¿™äº›å‰ç»çš„æ¦‚å¿µåæ˜ åˆ°ç¼–ç¨‹è¯­è¨€ä¸­æ˜¯ååˆ†æœ‰è¶£çš„ï¼Œè¿˜å®¹æ˜“ä½¿ç”¨ã€‚

Swift è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç‰¹æ€§å¯ä»¥ä½¿ä½ çš„ä»£ç æ›´æœ‰è¡¨è¾¾åŠ›ã€‚

- åŠŸèƒ½å¼ºå¤§ã€ç®€å•æ˜“ç”¨çš„æ³›å‹ï¼ˆGenericsï¼‰
- åè®®æ‰©å±•ï¼ˆProtocol extensionsï¼‰è®©åŒæ ·ä»£ç ç¼–å†™æ›´åŠ å®¹æ˜“
- ç¬¬ä¸€ç±»å‡½æ•°ï¼ˆFirst class functionsï¼‰å’Œè½»é‡çº§çš„é—­åŒ…ï¼ˆclosureï¼‰è¯­æ³•
- å¯¹èŒƒå›´ï¼ˆrangeï¼‰å’Œé›†åˆï¼ˆcollectionï¼‰çš„è¿­ä»£å¿«é€Ÿè€Œç®€æ´
- å…ƒç»„ï¼ˆTupleï¼‰å’Œå¤šè¿”å›å€¼
- æ”¯æŒæ–¹æ³•ã€æ‰©å±•ã€åè®®çš„ç»“æ„ï¼ˆStructsï¼‰
- æšä¸¾ï¼ˆEnumsï¼‰å¯ä»¥æœ‰è´Ÿè½½ï¼ˆpayloadsï¼‰ä¸”æ”¯æŒæ¨¡å¼åŒ¹é…
- å‡½æ•°åŒ–ç¼–ç¨‹ï¼Œæ¯”å¦‚ map å’Œ filter
- ä½¿ç”¨ `try`ã€`catch`ã€`throw` å¤„ç†åŸç”Ÿé”™è¯¯ï¼ˆNative errorï¼‰

> Rï¼šåå‘å‡½æ•°åŒ–çš„ï¼Œé›†å¤§æˆçš„è¯­æ³•ã€‚

## ä¸ºå®‰å…¨è€Œè®¾è®¡

Swift ç§»é™¤äº†å…¨éƒ¨ç±»å‹çš„ä¸å®‰å…¨ä»£ç ï¼ˆentire classes of unsafe codeï¼‰ã€‚å˜é‡åœ¨ä½¿ç”¨ä¹‹å‰å¿…é¡»åˆå§‹åŒ–ï¼Œæ•°ç»„å’Œæ•´å‹ä¼šæ£€æŸ¥ç›Šå¤„ï¼Œå†…å­˜è‡ªåŠ¨ç®¡ç†ï¼Œå¹¶ä¸”å¼ºåˆ¶çš„ç‹¬å å†…å­˜è®¿é—®å¯ä»¥é˜²æ­¢å¾ˆå¤šç¼–ç¨‹é”™è¯¯ã€‚è¯­æ³•ç»è¿‡è°ƒæ•´ï¼Œå¯ä»¥è½»æ¾å®šä¹‰ä½ çš„æ„å›¾ï¼Œæ¯”å¦‚ç®€å•çš„ 3 å­—ç¬¦å…³é”®å­—å®šä¹‰ä¸€ä¸ªå˜é‡ï¼ˆ`var`ï¼‰æˆ–è€…å¸¸é‡ï¼ˆ`let`ï¼‰ã€‚å¹¶ä¸” Swift å¤§é‡åˆ©ç”¨äº†å€¼ç±»å‹ï¼ˆvalue typesï¼‰ï¼Œå°¤å…¶æ˜¯ç»å¸¸ä½¿ç”¨çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚æ•°ç»„å’Œå­—å…¸ã€‚è¿™æ„å‘³ç€å½“ä½ å¯¹è¿™äº›æ•°æ®ç±»å‹çš„æ•°æ®è¿›è¡Œä¸€æ¬¡å¤åˆ¶ï¼Œä½ çŸ¥é“è¿™äº›å€¼ä¸ä¼šåœ¨å…¶ä»–ä»»ä½•åœ°æ–¹è¢«ä¿®æ”¹ã€‚

> Rï¼šValue Typesï¼Œå¯¹æ•°æ®å¤åˆ¶çš„æ—¶å€™å¤åˆ¶å…¶å€¼ï¼Œæ‰€ä»¥æ¯ä¸ªå¤åˆ¶éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„å®ä¾‹ï¼Œä¿®æ”¹ä¸ä¼šç›¸äº’å½±å“ã€‚ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ Reference Typesï¼Œæ¯æ¬¡å¤åˆ¶éƒ½ä»…å¤åˆ¶å¼•ç”¨ï¼Œæ¯ä¸ªå¤åˆ¶éƒ½å…±äº«åŒä¸€ä»½æ•°æ®ï¼Œæ•°æ®çš„ä¿®æ”¹å°†å½±å“æ‰€æœ‰å¤åˆ¶çš„å®ä¾‹ã€‚

å¦ä¸€ä¸ªå®‰å…¨æ–¹é¢çš„ç‰¹æ€§æ˜¯ï¼ŒSwift å¯¹è±¡æ°¸è¿œä¸ä¼šæ˜¯ `nil`ã€‚Swift çš„ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™æ¥é˜»æ­¢ä½ åˆ›å»ºæˆ–ä½¿ç”¨ä¸€ä¸ª `nil` å¯¹è±¡ã€‚è¿™ä¼šè®©ä»£ç æ›´åŠ æ¸…æ™°å’Œå®‰å…¨ï¼Œè€Œä¸”å¯ä»¥ä¸€ä¸‹å­é¿å…å¥½å‡ ä¸ªç›®å½•çš„è¶³ä»¥è®© App å´©æºƒçš„é—®é¢˜ã€‚å½“ç„¶ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ `nil` æ˜¯æœ‰æ•ˆä¸”è¢«å…è®¸çš„ã€‚Swift æœ‰ä¸€ä¸ªè¢«ç§°ä½œå¯é€‰å€¼ï¼ˆoptionalï¼‰çš„åˆ›æ–°ç‰¹æ€§é’ˆå¯¹è¿™äº›åœºæ™¯ã€‚ä¸€ä¸ªå¯é€‰å€¼å…è®¸ `nil`ï¼Œä½†æ˜¯ Swift çš„è¯­æ³•ä¼šå¼ºåˆ¶ä½ ä½¿ç”¨ `?` è¯­æ³•æ¥å‘Šè¯‰ç¼–è¯‘å™¨ä½ æ˜ç™½ä½ åœ¨åšä»€ä¹ˆå¹¶ä¼šå®‰å…¨å¤„ç†å®ƒã€‚

> R: ç±»ä¼¼ TypeScript é‡Œé¢å…³äºç±»å‹å®šä¹‰çš„ `?` è¯­æ³•ï¼Œè¡¨ç¤ºå…è®¸ `null` æˆ–è€… `undefined`ã€‚å¦å¤–åœ¨ Swift ä¸­ï¼Œå…¶ä»–è¯­è¨€ä¸­ç†ŸçŸ¥çš„ `null` è¢«ç§°ä¸º `nil`ã€‚

å½“ä¸€ä¸ªå‡½æ•°å¯èƒ½è¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œä¹Ÿå¯èƒ½ä»€ä¹ˆéƒ½ä¸è¿”å›çš„æ—¶å€™ï¼Œä½¿ç”¨å¯é€‰å€¼ã€‚

```swift
extension Collection where Element == Player {
    // Returns the highest score of all the players,
    // or `nil` if the collection is empty.
    func highestScoringPlayer() -> Player? {
        return self.max(by: { $0.highScore < $1.highScore })
    }
}
```

å¯é€‰å€¼ç»‘å®šï¼ˆoptional bindingï¼‰ï¼Œå¯é€‰å€¼é“¾ï¼ˆoptional chainingï¼‰å’Œ Nil è”åˆè¿ç®—ç¬¦ï¼ˆnil coalescingï¼‰ç­‰ç‰¹æ€§å¯ä»¥è®©ä½ å®‰å…¨å¹¶æœ‰æ•ˆç‡çš„å¤„ç†å¯é€‰å€¼ã€‚

```swift
if let bestPlayer = players.highestScoringPlayer() {
    recordHolder = """
        The record holder is \(bestPlayer.name),\
        with a high score of \(bestPlayer.highScore)!
        """
} else {
    recordHolder = "No games have been played yet.")
}
print(recordHolder)
// The record holder is Erin, with a high score of 271!

let highestScore = players.highestScoringPlayer()?.highScore ?? 0
// highestScore == 271
```

> Rï¼šNil Coalescing ç±»ä¼¼ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œç®€åŒ–ç‰ˆçš„ã€‚

## å¿«é€Ÿçš„ã€åŠŸèƒ½å¼ºå¤§çš„

Swift ä»æœ€åˆçš„è®¾è®¡ä¸Šå°±æ˜¯ä¸ºäº†â€œå¿«é€Ÿâ€è€Œç”Ÿçš„ã€‚Swift ä»£ç ä½¿ç”¨æ€§èƒ½ç‰›æ‰¹çš„ LLVM ç¼–è¯‘å™¨æŠ€æœ¯ï¼Œç¼–è¯‘æˆä¼˜åŒ–è¿‡çš„åŸç”Ÿä»£ç ï¼Œå……åˆ†åˆ©ç”¨ç°ä»£ç¡¬ä»¶çš„æ€§èƒ½ã€‚å®ƒçš„è¯­æ³•å’Œæ ‡å‡†åº“åŒæ ·ç»è¿‡è°ƒæ•´ï¼Œå¯ä»¥è®©ä½ ä»¥æœ€ä¸€ç›®äº†ç„¶çš„æ–¹å¼å†™å‡ºæ¥çš„ä»£ç åŒæ ·å¯ä»¥è·å¾—æœ€å¥½çš„æ€§èƒ½ï¼Œæ— è®ºå…¶æ˜¯è¿è¡Œåœ¨ä½ çš„æ‰‹è¡¨ä¸Šæˆ–è€…æ˜¯ä¸€ç»„æœåŠ¡å™¨ä¸­ã€‚

Swift æ˜¯ C å’Œ Objective-C ä¸¤è€…çš„ç»§æ‰¿è€…ã€‚å®ƒåŒ…å«åº•å±‚çš„åŸå‹ï¼Œæ¯”å¦‚åŸºæœ¬ç±»å‹ã€æµç¨‹æ§åˆ¶å’Œæ“ä½œç¬¦ã€‚å®ƒä¹Ÿæä¾›é¢å‘å¯¹è±¡çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ classã€åè®®å’Œæ³›å‹ï¼Œç»™ Cocoa å’Œ Cocoa Touch å¼€å‘è€…ä»¬è¦æ±‚çš„æ€§èƒ½å’ŒåŠŸèƒ½ã€‚

# ç›¸å…³

> 2.[Official Tutorial - Swift Syntax Basics](https://github.com/zfanli/notes/blob/master/swift/2.SwiftSyntaxBasis.md)
